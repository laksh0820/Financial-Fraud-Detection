{
  "best_experiment": {
    "seed": 888,
    "config": {
      "downsampled_upweight": 60,
      "target_ratio": 0.45,
      "max_epochs": 500,
      "patience": 20,
      "learning_rate": 0.001,
      "weight_decay": 0.01,
      "focal_gamma": 2.0,
      "focal_weight": 0.7,
      "model_params": {
        "hidden_dim": 64,
        "heads": 4,
        "num_gnn_layers": 3,
        "dropout": 0.3
      }
    },
    "start_time": "2025-10-13T16:47:47.303099",
    "train_losses": [
      3283.13525390625,
      1895.466796875,
      1129.995849609375,
      781.909912109375,
      547.25439453125,
      423.37933349609375,
      345.2722473144531,
      259.391357421875,
      206.91024780273438,
      157.68565368652344,
      134.09579467773438,
      139.54295349121094,
      113.6352310180664,
      100.37660217285156,
      81.4249267578125,
      70.8808822631836,
      60.92201232910156,
      47.062034606933594,
      62.40231704711914,
      29.608165740966797,
      29.065555572509766,
      18.678831100463867,
      10.348709106445312,
      5.87711763381958,
      3.8825087547302246,
      3.2743191719055176,
      2.1773557662963867,
      1.6077309846878052,
      1.2474476099014282,
      0.9193497896194458,
      0.6903424263000488,
      0.6444512009620667,
      0.5300833582878113,
      0.3916597366333008
    ],
    "val_metrics": [
      {
        "auc": 0.506962962962963,
        "ap": 0.08464553393385134,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.5162135270932997,
        "ap": 0.08612466110929051,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.5879097993200348,
        "ap": 0.0997154103514909,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.7210654992929565,
        "ap": 0.14178019621627394,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.7978020278605169,
        "ap": 0.1886406670040568,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.8712496013478954,
        "ap": 0.28162518435590034,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.8571530824081596,
        "ap": 0.2568712188203085,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.84997993200349,
        "ap": 0.2506088136858708,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.8750031290429341,
        "ap": 0.29110250820434075,
        "f1": 0.4614727854855923,
        "precision": 0.31297046902142445,
        "recall": 0.8781478472786353,
        "specificity": 0.8242222222222222,
        "optimal_threshold": 0.9367579817771912,
        "confusion_matrix": [
          11127,
          2373,
          150,
          1081
        ]
      },
      {
        "auc": 0.8825043475644613,
        "ap": 0.3124799163855139,
        "f1": 0.4682884448305821,
        "precision": 0.3195967981025793,
        "recall": 0.875710804224208,
        "specificity": 0.83,
        "optimal_threshold": 0.9998688697814941,
        "confusion_matrix": [
          11205,
          2295,
          153,
          1078
        ]
      },
      {
        "auc": 0.8852251406564974,
        "ap": 0.3195974936461513,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.8879352829677769,
        "ap": 0.3147621664592374,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.8779565544423384,
        "ap": 0.29394571308207307,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.9603985919306797,
        "ap": 0.6136341137383966,
        "f1": 0.7244929797191888,
        "precision": 0.5881458966565349,
        "recall": 0.9431356620633631,
        "specificity": 0.9397777777777778,
        "optimal_threshold": 0.934184730052948,
        "confusion_matrix": [
          12687,
          813,
          70,
          1161
        ]
      },
      {
        "auc": 0.9057803351686373,
        "ap": 0.37452827523479437,
        "f1": 0.5220045789875349,
        "precision": 0.38,
        "recall": 0.8334687246141349,
        "specificity": 0.876,
        "optimal_threshold": 0.9999741315841675,
        "confusion_matrix": [
          11826,
          1674,
          205,
          1026
        ]
      },
      {
        "auc": 0.8657179348316635,
        "ap": 0.2701856892872692,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.8884882209585702,
        "ap": 0.3122361249939082,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.8497189277010561,
        "ap": 0.2459219406434488,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.8674601197460661,
        "ap": 0.27179250481819806,
        "f1": 0.423705453829494,
        "precision": 0.2796257796257796,
        "recall": 0.8740861088545898,
        "specificity": 0.7946666666666666,
        "optimal_threshold": 0.9999994039535522,
        "confusion_matrix": [
          10728,
          2772,
          155,
          1076
        ]
      },
      {
        "auc": 0.8342411469145832,
        "ap": 0.23718849237703565,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.7177940247314738,
        "ap": 0.15368457030813726,
        "f1": 0.2433216608304152,
        "precision": 0.13874942948425376,
        "recall": 0.9878147847278635,
        "specificity": 0.4408888888888889,
        "optimal_threshold": 0.46672630310058594,
        "confusion_matrix": [
          5952,
          7548,
          15,
          1216
        ]
      },
      {
        "auc": 0.6737448024791647,
        "ap": 0.1360054282938355,
        "f1": 0.21639344262295082,
        "precision": 0.12144420131291028,
        "recall": 0.991876523151909,
        "specificity": 0.3457037037037037,
        "optimal_threshold": 0.4110659062862396,
        "confusion_matrix": [
          4667,
          8833,
          10,
          1221
        ]
      },
      {
        "auc": 0.6213738002828173,
        "ap": 0.10845256035266307,
        "f1": 0.03262092238470191,
        "precision": 0.05301645338208409,
        "recall": 0.023558082859463852,
        "specificity": 0.9616296296296296,
        "optimal_threshold": 0.5194967985153198,
        "confusion_matrix": [
          12982,
          518,
          1202,
          29
        ]
      },
      {
        "auc": 0.6157092096157897,
        "ap": 0.11157226749513421,
        "f1": 0.014492753623188406,
        "precision": 0.8181818181818182,
        "recall": 0.007311129163281885,
        "specificity": 0.9998518518518519,
        "optimal_threshold": 0.5190295577049255,
        "confusion_matrix": [
          13498,
          2,
          1222,
          9
        ]
      },
      {
        "auc": 0.5842982519481301,
        "ap": 0.10327762030909478,
        "f1": 0.01129032258064516,
        "precision": 0.7777777777777778,
        "recall": 0.005686433793663688,
        "specificity": 0.9998518518518519,
        "optimal_threshold": 0.5186905860900879,
        "confusion_matrix": [
          13498,
          2,
          1224,
          7
        ]
      },
      {
        "auc": 0.5728843758461956,
        "ap": 0.10091105838543847,
        "f1": 0.01129032258064516,
        "precision": 0.7777777777777778,
        "recall": 0.005686433793663688,
        "specificity": 0.9998518518518519,
        "optimal_threshold": 0.5184960961341858,
        "confusion_matrix": [
          13498,
          2,
          1224,
          7
        ]
      },
      {
        "auc": 0.5690127267803954,
        "ap": 0.10013545868953068,
        "f1": 0.01129032258064516,
        "precision": 0.7777777777777778,
        "recall": 0.005686433793663688,
        "specificity": 0.9998518518518519,
        "optimal_threshold": 0.5182787775993347,
        "confusion_matrix": [
          13498,
          2,
          1224,
          7
        ]
      },
      {
        "auc": 0.5661331949333575,
        "ap": 0.09948821038282099,
        "f1": 0.01129032258064516,
        "precision": 0.7777777777777778,
        "recall": 0.005686433793663688,
        "specificity": 0.9998518518518519,
        "optimal_threshold": 0.5180597901344299,
        "confusion_matrix": [
          13498,
          2,
          1224,
          7
        ]
      },
      {
        "auc": 0.562159370580979,
        "ap": 0.09879362206372042,
        "f1": 0.01129032258064516,
        "precision": 0.7777777777777778,
        "recall": 0.005686433793663688,
        "specificity": 0.9998518518518519,
        "optimal_threshold": 0.5178230404853821,
        "confusion_matrix": [
          13498,
          2,
          1224,
          7
        ]
      },
      {
        "auc": 0.5553768691518488,
        "ap": 0.09751377356309122,
        "f1": 0.011272141706924315,
        "precision": 0.6363636363636364,
        "recall": 0.005686433793663688,
        "specificity": 0.9997037037037036,
        "optimal_threshold": 0.517573893070221,
        "confusion_matrix": [
          13496,
          4,
          1224,
          7
        ]
      },
      {
        "auc": 0.5477772362126546,
        "ap": 0.09601428642295465,
        "f1": 0.011281224818694601,
        "precision": 0.7,
        "recall": 0.005686433793663688,
        "specificity": 0.9997777777777778,
        "optimal_threshold": 0.5173140168190002,
        "confusion_matrix": [
          13497,
          3,
          1224,
          7
        ]
      },
      {
        "auc": 0.538013839997593,
        "ap": 0.09320646361672534,
        "f1": 0.008077544426494346,
        "precision": 0.7142857142857143,
        "recall": 0.004061738424045491,
        "specificity": 0.9998518518518519,
        "optimal_threshold": 0.5170423984527588,
        "confusion_matrix": [
          13498,
          2,
          1226,
          5
        ]
      },
      {
        "auc": 0.5284291602731894,
        "ap": 0.09155229757886751,
        "f1": 0.008077544426494346,
        "precision": 0.7142857142857143,
        "recall": 0.004061738424045491,
        "specificity": 0.9998518518518519,
        "optimal_threshold": 0.5167659521102905,
        "confusion_matrix": [
          13498,
          2,
          1226,
          5
        ]
      },
      {
        "auc": 0.5192098564852423,
        "ap": 0.09002470136131692,
        "f1": 0.008071025020177564,
        "precision": 0.625,
        "recall": 0.004061738424045491,
        "specificity": 0.9997777777777778,
        "optimal_threshold": 0.5164819955825806,
        "confusion_matrix": [
          13497,
          3,
          1226,
          5
        ]
      }
    ],
    "best_val_f1": 0.7244929797191888,
    "best_epoch": 13,
    "final_test_metrics": {
      "auc": 0.9645057315642205,
      "ap": 0.622379165816226,
      "f1": 0.7080200501253132,
      "precision": 0.5762366139724631,
      "recall": 0.9179528838342811,
      "specificity": 0.9384444444444444,
      "optimal_threshold": 0.982571542263031,
      "confusion_matrix": [
        12669,
        831,
        101,
        1130
      ]
    },
    "end_time": "2025-10-13T16:49:09.469263",
    "model_path": "models/best_fraud_model_seed_888.pth",
    "total_epochs": 34,
    "training_time_seconds": 82.166164
  },
  "feature_analysis": {
    "transaction_types": {
      "TRANSFER": {
        "count": 692,
        "percentage": 31.468849477035015
      },
      "CASH_OUT": {
        "count": 1158,
        "percentage": 52.660300136425654
      },
      "CASH_IN": {
        "count": 349,
        "percentage": 15.870850386539336
      }
    },
    "amount_statistics": {
      "mean": 1106247.875,
      "median": 289039.71875,
      "std": 2257798.25,
      "min": 0.0,
      "max": 10000000.0
    }
  }
}