{
  "best_experiment": {
    "seed": 444,
    "config": {
      "downsampled_upweight": 60,
      "target_ratio": 0.45,
      "max_epochs": 500,
      "patience": 20,
      "learning_rate": 0.001,
      "weight_decay": 0.01,
      "focal_gamma": 2.0,
      "focal_weight": 0.7,
      "model_params": {
        "hidden_dim": 64,
        "heads": 4,
        "num_gnn_layers": 3,
        "dropout": 0.3
      }
    },
    "start_time": "2025-10-20T17:32:18.133043",
    "train_losses": [
      6246.3232421875,
      1886.0455322265625,
      1422.6103515625,
      1006.6795043945312,
      735.2406005859375,
      564.2737426757812,
      417.1768798828125,
      302.65130615234375,
      238.441162109375,
      187.27633666992188,
      154.74261474609375,
      118.72383117675781,
      92.87598419189453,
      79.86750793457031,
      71.537109375,
      63.84065246582031,
      58.774017333984375,
      53.946990966796875,
      49.76715087890625,
      43.52369689941406,
      38.15602111816406,
      33.66685485839844,
      30.450851440429688,
      26.135866165161133,
      24.00217628479004,
      21.993406295776367,
      19.16362762451172,
      16.84304428100586,
      14.360264778137207,
      12.427887916564941,
      11.612977981567383,
      10.376463890075684,
      9.86023235321045,
      8.74682903289795,
      8.317251205444336,
      7.649723052978516,
      7.12315559387207,
      6.475815773010254,
      6.191958427429199,
      5.420365810394287,
      4.899459362030029,
      4.887089252471924,
      4.688214302062988,
      3.8627257347106934,
      3.217113971710205,
      3.5966763496398926,
      3.9712531566619873,
      3.8834872245788574,
      4.618701457977295,
      3.125856876373291,
      3.9272584915161133,
      2.8075149059295654,
      2.7716593742370605,
      2.6360561847686768,
      2.7459473609924316,
      2.426464557647705,
      2.020728349685669,
      2.381488800048828,
      1.9256396293640137,
      1.6539815664291382
    ],
    "val_metrics": [
      {
        "auc": 0.5323799681078316,
        "ap": 0.08884059236120138,
        "f1": 0.1630297804603038,
        "precision": 0.0887620973566373,
        "recall": 0.9983753046303818,
        "specificity": 0.06540740740740741,
        "optimal_threshold": 0.9999881982803345,
        "confusion_matrix": [
          883,
          12617,
          2,
          1229
        ]
      },
      {
        "auc": 0.5729032102777025,
        "ap": 0.09647050062259224,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.688506724433613,
        "ap": 0.1283872317236555,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.6412903390799409,
        "ap": 0.11303019772992037,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.5892894063844512,
        "ap": 0.09996676913612698,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.6193968168005536,
        "ap": 0.10710888214391945,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.6732399434365315,
        "ap": 0.12317444235392284,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.7021865992718958,
        "ap": 0.13411472955439455,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.7123852634112585,
        "ap": 0.13844985447844052,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.7239700033095646,
        "ap": 0.14401688885129277,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.7334624665282666,
        "ap": 0.14866156980370815,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.7389501158347626,
        "ap": 0.15168064892598604,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.7430034900863496,
        "ap": 0.15420587851757767,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.7539209916659144,
        "ap": 0.16105287007224514,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.7749496645304931,
        "ap": 0.17495484879416362,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.8224895748713783,
        "ap": 0.22891806776554724,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.8980544874687848,
        "ap": 0.48908198811412035,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.9332155429190361,
        "ap": 0.6963551597502864,
        "f1": 0.6392823418319168,
        "precision": 0.7632468996617813,
        "recall": 0.5499593826157595,
        "specificity": 0.9844444444444445,
        "optimal_threshold": 0.9997597336769104,
        "confusion_matrix": [
          13290,
          210,
          554,
          677
        ]
      },
      {
        "auc": 0.9279935012185214,
        "ap": 0.5515248975807301,
        "f1": 0.5478806907378335,
        "precision": 0.5299924069855733,
        "recall": 0.5670186839967506,
        "specificity": 0.9541481481481482,
        "optimal_threshold": 0.9381844401359558,
        "confusion_matrix": [
          12881,
          619,
          533,
          698
        ]
      },
      {
        "auc": 0.8768702951529921,
        "ap": 0.34431848699205964,
        "f1": 0.4280442804428044,
        "precision": 0.39215686274509803,
        "recall": 0.471161657189277,
        "specificity": 0.9334074074074074,
        "optimal_threshold": 0.9814547896385193,
        "confusion_matrix": [
          12601,
          899,
          651,
          580
        ]
      },
      {
        "auc": 0.8818945452357313,
        "ap": 0.40505446735553696,
        "f1": 0.49569707401032703,
        "precision": 0.5269899359560841,
        "recall": 0.46791226645004064,
        "specificity": 0.9617037037037037,
        "optimal_threshold": 0.9999998807907104,
        "confusion_matrix": [
          12983,
          517,
          655,
          576
        ]
      },
      {
        "auc": 0.8538966513223215,
        "ap": 0.3173693540960071,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.8373374251587086,
        "ap": 0.2745658289038544,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.839597948069922,
        "ap": 0.28626733535360294,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.8710340584288594,
        "ap": 0.4026306097683119,
        "f1": 0,
        "precision": 0,
        "recall": 0.0,
        "specificity": 1.0,
        "optimal_threshold": 1.0,
        "confusion_matrix": [
          13500,
          0,
          1231,
          0
        ]
      },
      {
        "auc": 0.9060528627734152,
        "ap": 0.5963423035530228,
        "f1": 0.5963987703118138,
        "precision": 0.6491395793499044,
        "recall": 0.5515840779853778,
        "specificity": 0.9728148148148148,
        "optimal_threshold": 0.999910831451416,
        "confusion_matrix": [
          13133,
          367,
          552,
          679
        ]
      },
      {
        "auc": 0.9070097481722177,
        "ap": 0.6825774829262344,
        "f1": 0.6275924256086565,
        "precision": 0.7051671732522796,
        "recall": 0.5653939886271324,
        "specificity": 0.9784444444444444,
        "optimal_threshold": 0.9758785367012024,
        "confusion_matrix": [
          13209,
          291,
          535,
          696
        ]
      },
      {
        "auc": 0.8767424857839154,
        "ap": 0.6494593109453795,
        "f1": 0.6005665722379603,
        "precision": 0.7170236753100339,
        "recall": 0.5166531275385865,
        "specificity": 0.9814074074074074,
        "optimal_threshold": 0.9387359023094177,
        "confusion_matrix": [
          13249,
          251,
          595,
          636
        ]
      },
      {
        "auc": 0.842818485422872,
        "ap": 0.29869246701476887,
        "f1": 0.40636544472861613,
        "precision": 0.3125,
        "recall": 0.5808285946385053,
        "specificity": 0.8834814814814815,
        "optimal_threshold": 0.770792543888092,
        "confusion_matrix": [
          11927,
          1573,
          516,
          715
        ]
      },
      {
        "auc": 0.8746165418058189,
        "ap": 0.27096762507427696,
        "f1": 0.4078875296695271,
        "precision": 0.2630711257654263,
        "recall": 0.9073923639317628,
        "specificity": 0.7682222222222223,
        "optimal_threshold": 0.5214033722877502,
        "confusion_matrix": [
          10371,
          3129,
          114,
          1117
        ]
      },
      {
        "auc": 0.8931501338869334,
        "ap": 0.3170404964736133,
        "f1": 0.45047388961159635,
        "precision": 0.29204819277108435,
        "recall": 0.9845653939886271,
        "specificity": 0.7823703703703704,
        "optimal_threshold": 0.5150895714759827,
        "confusion_matrix": [
          10562,
          2938,
          19,
          1212
        ]
      },
      {
        "auc": 0.9342718957788007,
        "ap": 0.70441162813995,
        "f1": 0.6408640864086408,
        "precision": 0.7184661957618567,
        "recall": 0.578391551584078,
        "specificity": 0.9793333333333333,
        "optimal_threshold": 0.9415047764778137,
        "confusion_matrix": [
          13221,
          279,
          519,
          712
        ]
      },
      {
        "auc": 0.9428081355116286,
        "ap": 0.6888858176828692,
        "f1": 0.6013579049466538,
        "precision": 0.7460890493381468,
        "recall": 0.503655564581641,
        "specificity": 0.9843703703703703,
        "optimal_threshold": 0.8439501523971558,
        "confusion_matrix": [
          13289,
          211,
          611,
          620
        ]
      },
      {
        "auc": 0.9389147937539489,
        "ap": 0.5517064855880072,
        "f1": 0.6417594064652888,
        "precision": 0.4762092017302399,
        "recall": 0.983753046303818,
        "specificity": 0.9013333333333333,
        "optimal_threshold": 0.5074643492698669,
        "confusion_matrix": [
          12168,
          1332,
          20,
          1211
        ]
      },
      {
        "auc": 0.9498011252519784,
        "ap": 0.563185328581708,
        "f1": 0.7143282692880548,
        "precision": 0.5639698965192851,
        "recall": 0.9740048740861088,
        "specificity": 0.9313333333333333,
        "optimal_threshold": 0.502496063709259,
        "confusion_matrix": [
          12573,
          927,
          32,
          1199
        ]
      },
      {
        "auc": 0.9098658422842013,
        "ap": 0.7191914574759052,
        "f1": 0.6636197440585009,
        "precision": 0.7586206896551724,
        "recall": 0.5897644191714053,
        "specificity": 0.9828888888888889,
        "optimal_threshold": 0.6678962111473083,
        "confusion_matrix": [
          13269,
          231,
          505,
          726
        ]
      },
      {
        "auc": 0.9246051388512803,
        "ap": 0.7443388692974844,
        "f1": 0.6749358426005132,
        "precision": 0.7127371273712737,
        "recall": 0.6409423233143785,
        "specificity": 0.9764444444444444,
        "optimal_threshold": 0.7864071130752563,
        "confusion_matrix": [
          13182,
          318,
          442,
          789
        ]
      },
      {
        "auc": 0.9177263591780245,
        "ap": 0.7061732859388381,
        "f1": 0.6377922575699502,
        "precision": 0.6037735849056604,
        "recall": 0.6758732737611698,
        "specificity": 0.9595555555555556,
        "optimal_threshold": 0.5637099742889404,
        "confusion_matrix": [
          12954,
          546,
          399,
          832
        ]
      },
      {
        "auc": 0.6779746968739657,
        "ap": 0.15416069060558402,
        "f1": 0.06742857142857142,
        "precision": 0.11368015414258188,
        "recall": 0.0479285134037368,
        "specificity": 0.965925925925926,
        "optimal_threshold": 0.477469801902771,
        "confusion_matrix": [
          13040,
          460,
          1172,
          59
        ]
      },
      {
        "auc": 0.9744154406234015,
        "ap": 0.7727653138596823,
        "f1": 0.8145454545454545,
        "precision": 0.7373271889400922,
        "recall": 0.9098294069861901,
        "specificity": 0.9704444444444444,
        "optimal_threshold": 0.501234233379364,
        "confusion_matrix": [
          13101,
          399,
          111,
          1120
        ]
      },
      {
        "auc": 0.9572084724854831,
        "ap": 0.7540087368773715,
        "f1": 0.6539862403885066,
        "precision": 0.6516129032258065,
        "recall": 0.6563769293257514,
        "specificity": 0.968,
        "optimal_threshold": 0.6591137051582336,
        "confusion_matrix": [
          13068,
          432,
          423,
          808
        ]
      },
      {
        "auc": 0.9536130818064203,
        "ap": 0.7475327815574937,
        "f1": 0.6630434782608696,
        "precision": 0.6830318690783808,
        "recall": 0.644191714053615,
        "specificity": 0.9727407407407408,
        "optimal_threshold": 0.9455679655075073,
        "confusion_matrix": [
          13132,
          368,
          438,
          793
        ]
      },
      {
        "auc": 0.9106896230105003,
        "ap": 0.6118692426618026,
        "f1": 0.5660377358490566,
        "precision": 0.5595238095238095,
        "recall": 0.5727051177904143,
        "specificity": 0.9588888888888889,
        "optimal_threshold": 0.975922703742981,
        "confusion_matrix": [
          12945,
          555,
          526,
          705
        ]
      },
      {
        "auc": 0.8910358636459368,
        "ap": 0.522666748605031,
        "f1": 0.5149406467458044,
        "precision": 0.518976897689769,
        "recall": 0.5109666937449229,
        "specificity": 0.9568148148148148,
        "optimal_threshold": 0.9238974452018738,
        "confusion_matrix": [
          12917,
          583,
          602,
          629
        ]
      },
      {
        "auc": 0.9065640099888679,
        "ap": 0.5390532267716197,
        "f1": 0.5216652506372133,
        "precision": 0.5467497773820125,
        "recall": 0.49878147847278637,
        "specificity": 0.9622962962962963,
        "optimal_threshold": 0.8833410143852234,
        "confusion_matrix": [
          12991,
          509,
          617,
          614
        ]
      },
      {
        "auc": 0.9339552306164817,
        "ap": 0.625397353190745,
        "f1": 0.5737976782752903,
        "precision": 0.5859441151566469,
        "recall": 0.5621445978878961,
        "specificity": 0.9637777777777777,
        "optimal_threshold": 0.9925600290298462,
        "confusion_matrix": [
          13011,
          489,
          539,
          692
        ]
      },
      {
        "auc": 0.8691711947528359,
        "ap": 0.40516396439959157,
        "f1": 0.4070996978851964,
        "precision": 0.3803810868031052,
        "recall": 0.437855402112104,
        "specificity": 0.934962962962963,
        "optimal_threshold": 0.9910178184509277,
        "confusion_matrix": [
          12622,
          878,
          692,
          539
        ]
      },
      {
        "auc": 0.8813775611517286,
        "ap": 0.5066743914068453,
        "f1": 0.4958061509785647,
        "precision": 0.5814207650273224,
        "recall": 0.4321689683184403,
        "specificity": 0.9716296296296296,
        "optimal_threshold": 0.9983505010604858,
        "confusion_matrix": [
          13117,
          383,
          699,
          532
        ]
      },
      {
        "auc": 0.9632907302103079,
        "ap": 0.6660694894992408,
        "f1": 0.7000695894224078,
        "precision": 0.6122945830797322,
        "recall": 0.8172217709179529,
        "specificity": 0.9528148148148148,
        "optimal_threshold": 0.9802635312080383,
        "confusion_matrix": [
          12863,
          637,
          225,
          1006
        ]
      },
      {
        "auc": 0.9589795408731233,
        "ap": 0.773349040991897,
        "f1": 0.6811098441657164,
        "precision": 0.64,
        "recall": 0.7278635255889521,
        "specificity": 0.9626666666666667,
        "optimal_threshold": 0.9638611674308777,
        "confusion_matrix": [
          12996,
          504,
          335,
          896
        ]
      },
      {
        "auc": 0.958325179769534,
        "ap": 0.7177897823565121,
        "f1": 0.6313839640116432,
        "precision": 0.4682103610675039,
        "recall": 0.9691307879772543,
        "specificity": 0.8996296296296297,
        "optimal_threshold": 0.6718602180480957,
        "confusion_matrix": [
          12145,
          1355,
          38,
          1193
        ]
      },
      {
        "auc": 0.9443581550681469,
        "ap": 0.45091473118729014,
        "f1": 0.6739679865206403,
        "precision": 0.5150214592274678,
        "recall": 0.974817221770918,
        "specificity": 0.9162962962962963,
        "optimal_threshold": 0.7491806149482727,
        "confusion_matrix": [
          12370,
          1130,
          31,
          1200
        ]
      },
      {
        "auc": 0.9511535938863316,
        "ap": 0.6561520125984454,
        "f1": 0.6063448275862068,
        "precision": 0.4590643274853801,
        "recall": 0.892770105605199,
        "specificity": 0.904074074074074,
        "optimal_threshold": 0.8806836009025574,
        "confusion_matrix": [
          12205,
          1295,
          132,
          1099
        ]
      },
      {
        "auc": 0.9459106417546709,
        "ap": 0.6899863864877499,
        "f1": 0.6178428761651131,
        "precision": 0.6810176125244618,
        "recall": 0.5653939886271324,
        "specificity": 0.9758518518518519,
        "optimal_threshold": 0.9882086515426636,
        "confusion_matrix": [
          13174,
          326,
          535,
          696
        ]
      },
      {
        "auc": 0.9553126635977977,
        "ap": 0.6767754850134173,
        "f1": 0.6586517818806354,
        "precision": 0.6985428051001822,
        "recall": 0.6230706742485784,
        "specificity": 0.9754814814814815,
        "optimal_threshold": 0.999994158744812,
        "confusion_matrix": [
          13169,
          331,
          464,
          767
        ]
      },
      {
        "auc": 0.9681770917952883,
        "ap": 0.7913928261067505,
        "f1": 0.6949646275488971,
        "precision": 0.712457337883959,
        "recall": 0.6783103168155971,
        "specificity": 0.975037037037037,
        "optimal_threshold": 0.9986411929130554,
        "confusion_matrix": [
          13163,
          337,
          396,
          835
        ]
      },
      {
        "auc": 0.775193489183741,
        "ap": 0.3154273938099842,
        "f1": 0.31783067948920063,
        "precision": 0.19718309859154928,
        "recall": 0.8188464662875711,
        "specificity": 0.696,
        "optimal_threshold": 0.49134260416030884,
        "confusion_matrix": [
          9396,
          4104,
          223,
          1008
        ]
      },
      {
        "auc": 0.5669061287119775,
        "ap": 0.12847388702095883,
        "f1": 0.025522552255225518,
        "precision": 0.017501508750754374,
        "recall": 0.047116165718927704,
        "specificity": 0.7588148148148148,
        "optimal_threshold": 0.4765683710575104,
        "confusion_matrix": [
          10244,
          3256,
          1173,
          58
        ]
      },
      {
        "auc": 0.6164244065348858,
        "ap": 0.13388707056244578,
        "f1": 0.029183483390251473,
        "precision": 0.023618090452261306,
        "recall": 0.038180341186027617,
        "specificity": 0.8560740740740741,
        "optimal_threshold": 0.4765268862247467,
        "confusion_matrix": [
          11557,
          1943,
          1184,
          47
        ]
      },
      {
        "auc": 0.6521622288413514,
        "ap": 0.1500874836204222,
        "f1": 0.03201874267864116,
        "precision": 0.030827067669172932,
        "recall": 0.03330625507717303,
        "specificity": 0.9045185185185185,
        "optimal_threshold": 0.4764823913574219,
        "confusion_matrix": [
          12211,
          1289,
          1190,
          41
        ]
      }
    ],
    "best_val_f1": 0.8145454545454545,
    "best_epoch": 39,
    "final_test_metrics": {
      "auc": 0.9764728766134129,
      "ap": 0.7774854800004574,
      "f1": 0.8127159640635798,
      "precision": 0.7071557426337943,
      "recall": 0.9553208773354996,
      "specificity": 0.963925925925926,
      "optimal_threshold": 0.5023131966590881,
      "confusion_matrix": [
        13013,
        487,
        55,
        1176
      ]
    },
    "end_time": "2025-10-20T17:35:14.583417",
    "model_path": "models/best_fraud_model_seed_444.pth",
    "total_epochs": 60,
    "training_time_seconds": 176.450374
  },
  "feature_analysis": {
    "transaction_types": {
      "TRANSFER": {
        "count": 68,
        "percentage": 48.92086330935252
      },
      "CASH_OUT": {
        "count": 71,
        "percentage": 51.07913669064749
      }
    },
    "amount_statistics": {
      "mean": 7943249.0,
      "median": 10000000.0,
      "std": 3602469.25,
      "min": 0.0,
      "max": 10000000.0
    }
  }
}